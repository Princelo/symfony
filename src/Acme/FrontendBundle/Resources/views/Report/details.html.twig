{% extends 'AcmeFrontendBundle:Default:base.html.twig' %}

{% block body %}
    <div class="main-partition">
    <div id="play-bar">
        <span class="close-btn" onclick="stop()"></span>
    </div>
    <div class="report-list details">
        <div class="title">
            <span class="fm">投票媒体</span>
            <span class="index">名次</span>
            <span class="week">周次</span>
            <span class="last-index">上周排名</span>
            <span class="top-index">最高排名</span>
            <span class="score">得分</span>
            <span class="change">浮动</span>
            <span class="title">歌曲名称</span>
            <span class="artist">歌手</span>
            <span class="corp">唱片公司</span>
            <span class="play">试听</span>
        </div>
        <ul>
            {% for r in list %}
                <li  {% if loop.index is odd %}class="color"{% endif %}>
                    <span class="fm">{{ r.fm }}</span>
                    <span class="index">{{ r.rank_index }}</span>
                    <span class="week">{{ r.week_count }}</span>
                    <span class="last-index">{% if r.last_index > 0 %} {{ r.last_index }} {% else %} 未上榜 {% endif %}</span>
                    <span class="top-index">{{ r.top_index }}</span>
                    <span class="score">{{ r.score }}</span>
                    <span class="change">{{ r.last_index - r.rank_index }}</span>
                    <span class="title">{{ r.title }}</span>
                    <span class="artist">
                        {% for a in r.artists %}
                            {{ a.name }}
                        {% endfor %}
                    </span>
                    <span class="corp">{{ r.corp }}</span>
                        <span class="play">
                            <a href="javascript:;">*</a>
                        </span>
                </li>
            {% endfor %}
            <div style="clear:both"></div>
        </ul>
    </div>
    <script>
        var play = function(token, id)
        {
            $('audio').each(function(){
                $(this).remove();
                console.log('should remove');
            });
            $('.audiojs').remove();
            var player = '<audio src="{{ app.url }}/app_dev.php/play/'+token+'" preload="auto" />';
            $('#play-bar').show();
            $('#play-bar').append(player);
            audiojs.events.ready(function() {
                var as = audiojs.createAll();
            });
        }
        var stop = function()
        {
            $('audio').each(function(){
                $(this).remove();
                console.log('should remove');
            });
            $('.audiojs').remove();
            $('#play-bar').hide();
        }
    </script>
{% endblock %}